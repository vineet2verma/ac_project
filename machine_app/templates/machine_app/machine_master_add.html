{% extends "base.html" %}

{% block title %}Machine Master{% endblock %}
{% block navbartitle %}Machine Master{% endblock %}

{% block navbtn1 %}
<button class="btn btn-success btn-sm"
        data-bs-toggle="modal"
        data-bs-target="#machineMasterModal">
    + Add Machine
</button>
{% endblock %}

{% block content %}

<div class="container py-3">

    <!-- ================= MACHINE MASTER LIST ================= -->
    <div class="card shadow-sm">
        <div class="card-header fw-semibold">
            Machine List
        </div>

        <div class="table-responsive">
            <table class="table table-sm table-bordered mb-0">
                <thead class="table-light">
                <tr>
                    <th>#</th>
                    <th>Machine Name</th>
                    <th>Machine Code</th>
                    <th>Status</th>
                    <th style="width:100px">Action</th>
                </tr>
                </thead>

                <tbody>
                {% for m in machines %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ m.machine_name }}</td>
                    <td>{{ m.machine_code }}</td>
                    <td>
                        {% if m.is_active %}
                            <span class="badge bg-success">Active</span>
                        {% else %}
                            <span class="badge bg-secondary">Inactive</span>
                        {% endif %}
                    </td>
                    <td class="text-center">
                        <form method="POST"
                              action="{% url 'machine_app:machine_master_toggle' m.id %}">
                            {% csrf_token %}
                            <button class="btn btn-sm btn-outline-warning">
                                Toggle
                            </button>
                        </form>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center text-muted">
                        No machines added
                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

</div>

<!-- ================= ADD MACHINE MODAL ================= -->
<div class="modal fade" id="machineMasterModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <form method="POST"
                  action="{% url 'machine_app:machine_master_add' %}">
                {% csrf_token %}

                <div class="modal-header">
                    <h5 class="modal-title">Add Machine</h5>
                    <button class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">

                    <div class="mb-2">
                        <label class="form-label small">Machine Name</label>
                        <input name="machine_name"
                               class="form-control form-control-sm"
                               placeholder="CNC Router"
                               required>
                    </div>

                    <div class="mb-2">
                        <label class="form-label small">Machine Code</label>
                        <input name="machine_code"
                               class="form-control form-control-sm"
                               placeholder="CNC-01"
                               required>
                    </div>

                    <div class="form-check mt-2">
                        <input class="form-check-input"
                               type="checkbox"
                               name="is_active"
                               checked>
                        <label class="form-check-label small">
                            Active
                        </label>
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary btn-sm"
                            data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button class="btn btn-success btn-sm">
                        Save Machine
                    </button>
                </div>

            </form>

        </div>
    </div>
</div>

{% endblock %}
